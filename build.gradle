plugins {
    id 'groovy'
    id 'application'
    id 'com.intershop.gradle.jaxb' version '1.0.0'
}

mainClassName = 'edu.umn.pssa.ibmonitorservice.IBMonitorSvc'

repositories.jcenter()
dependencies {
    // mandatory dependencies for using Spock
    testCompile 'org.spockframework:spock-core:1.0-groovy-2.4'

    compile files('src/main/resources/ibmonitorconfig.jar')

    compile 'com.oracle:ojdbc6:11.2.0.3'
    compile 'log4j:log4j:1.2.17'
    compile 'javax.mail:mail:1.4.7'
    compile 'org.apache.commons:commons-configuration2:2.1'
    compile 'commons-beanutils:commons-beanutils:1.9.3'
}

run {
    if(System.getProperty("exec.args") != null) {
        args System.getProperty("exec.args").split()
    }
}

jaxb {
    // generate java code from schema
    javaGen {
        //generates a 'project' schema file from existing java code
        configType {
            packageName = 'edu.umn.pssa.ibmonitorservice'
            schema = file('src/main/resources/configs.xsd')
            //binding = file('binding.xjb')
        }
    }
}

//task compileJaxb(type:JavaCompile) {
task compileJaxb(dependsOn:jaxbJavaGenConfigType, type:JavaCompile) {
    source('build/generated/jaxb/java/configType')
    classpath = sourceSets.main.compileClasspath
    destinationDir = file('build/generated/jaxb/java/configType')
}

task jarJaxbJava(dependsOn:compileJaxb, type: Jar){
    archiveName = 'ibmonitorconfig.jar'
    from('build/generated/jaxb/java/configType')
    destinationDir = file('src/main/resources')
}
